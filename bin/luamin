#!/usr/bin/env node
(function() {

	var fs = require('fs');
	var minify = require('../luamin.js').minify;
	var snippets = process.argv.splice(2);
	var isFile = false;

	if (!snippets.length || /^(?:--help|-h)/.test(snippets[0])) {
		console.log('Usage:\n\tluamin [snippet ...]\n\tluamin [-f | --file] [file ...]');
		console.log('\nExamples:');
		console.log('\tluamin \'a = ((1 + 2) - 3) * (4 / (5 ^ 6))\'');
		console.log('\tluamin -f foo.lua');
		console.log('\tluamin --file bar.lua');
		process.exit(1);
	}

	if (/^(?:-f|--file)$/.test(snippets[0])) {
		isFile = true;
		snippets.shift();
	}

	snippets.forEach(function(snippet) {
		if (isFile) {
			snippet = fs.readFileSync(snippet, 'utf-8');
		}
		var result = minify(snippet);
		console.log(result);
	});

}());
